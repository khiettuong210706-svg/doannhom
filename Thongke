#include <iostream>
#include <vector>
#include <map>
#include <iomanip>
#include <string>
using namespace std;


struct Order {
    int id;
    string date;     
    string time;     
    bool completed;  
};

struct Product {
    int id;
    string name;
};

struct OrderItem {
    int orderId;
    int productId;
    int quantity;
};

struct Customer {
    int id;
    string name;
};



vector<Order> orders;

vector<Product> products;

vector<OrderItem> orderItems;



void ordersByDate() {
    map<string,int> cnt;
    for (auto o : orders)
        cnt[o.date]++;

    cout << "\nSo don theo ngay:\n";
    for (auto p : cnt)
        cout << p.first << " : " << p.second << endl;
}

void mostBusyHour() {
    map<string,int> hourCnt;
    for (auto o : orders)
        hourCnt[o.time]++;

    string hour;
    int mx = 0;
    for (auto p : hourCnt)
        if (p.second > mx) {
            mx = p.second;
            hour = p.first;
        }

    cout << "\nGio dat nhieu nhat: " << hour << "h\n";
}

void orderStatus() {
    int done = 0, shipping = 0;
    for (auto o : orders)
        o.completed ? done++ : shipping++;

    cout << "\nDon hoan thanh: " << done;
    cout << "\nDon dang giao: " << shipping << endl;
}



map<int,int> totalSold() {
    map<int,int> sold;
    for (auto i : orderItems)
        sold[i.productId] += i.quantity;
    return sold;
}

void bestAndWorstProduct() {
    auto sold = totalSold();

    int best = -1, worst = -1;
    for (auto p : sold) {
        if (best == -1 || p.second > sold[best]) best = p.first;
        if (worst == -1 || p.second < sold[worst]) worst = p.first;
    }

    for (auto pr : products) {
        if (pr.id == best)
            cout << "\nSan pham ban chay nhat: " << pr.name;
        if (pr.id == worst)
            cout << "\nSan pham ban it nhat: " << pr.name;
    }
    cout << endl;
}



void customerStats() {
    map<int,int> freq;
    for (auto o : orders)
        freq[o.customerId]++;

    int newCus = 0, returnCus = 0;
    for (auto p : freq)
        p.second == 1 ? newCus++ : returnCus++;

    cout << "\nKhach moi: " << newCus;
    cout << "\nKhach quay lai: " << returnCus << endl;
}

void customerFrequency() {
    map<int,int> freq;
    for (auto o : orders)
        freq[o.customerId]++;

    cout << "\nTan suat mua hang:\n";
    for (auto p : freq)
        cout << "Khach " << p.first << ": " << p.second << " don\n";
}



void revenueByDate() {
    map<string,int> revenue;

    for (auto i : orderItems) {
        for (auto o : orders)
            if (o.id == i.orderId)
                revenue[o.date] += i.quantity * 100;
    }

    cout << "\nDoanh thu theo ngay:\n";
    for (auto p : revenue)
        cout << p.first << " : " << p.second << "k\n";
}



void printTable() {
    auto sold = totalSold();

    cout << "\n+--------------+----------+\n";
    cout << "| San pham     | So luong |\n";
    cout << "+--------------+----------+\n";

    for (auto pr : products) {
        cout << "| " << setw(12) << left << pr.name
             << " | " << setw(8) << sold[pr.id] << " |\n";
    }

    cout << "+--------------+----------+\n";
}
